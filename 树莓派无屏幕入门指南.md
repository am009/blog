---
title: 树莓派无屏幕入门指南
date: 2020/01/11 20:46:25
categories:
- 树莓派
tags:
- raspberrypi
---

# 树莓派无屏幕入门指南

<!-- more -->

## 为什么有这篇文章

树莓派总是对有屏幕有键盘的人友好，但是拿树莓派接上屏幕当电脑用，就需要花钱买屏幕，单独配上键盘。
树莓派的官方系统可以不插屏幕开机，而其他的ubuntu mate等各种没有经过优化的系统则
在这个WiFi遍地的时代，越来越多的有线网被wifi侵占，我们宿舍已经没有有线网了，而普通的针对普通便携设备的系统WiFi则是可有可无的，而对我们无屏幕远程连接的人来说网络是致命的，这让我想到之前树莓派随时自闭无法ssh的时候，折腾得我死去活来的，也不知道是供电还是wifi的电源管理，反正现在一拿到系统就关闭wifi的电源管理了。sudo iw dev wlan0 set power_save off
一言难尽，想把树莓派当服务器不容易，这也是学习的过程吧。多看看arch wiki，有问题先找树莓派官方论坛，stackoverflow。

## 1 系统选择
https://github.com/openfans-community-offical/Debian-Pi-Aarch64
这个系统真是厉害，功能强大，高度定制，居然可以把wpa_supplicant.conf给链接到boot文件夹，这样就可以在刷完系统后直接在windows下插上sd卡配置wifi！
好像还可以运行游戏，不过我的树莓派3刷了后开机卡得半死不活。

Respbian 这个树莓派官方的系统还是不错的，无屏幕入门几乎唯一的选择。毕竟很多其他系统没有屏幕甚至开不了机。
就是还不出arm64的版本，虽然用起来好像没什么区别，但是感觉系统架构合适，效率会高一些。

不过自从了解到Xserver这个东西之后，就感觉这种服务器的图形界面没有什么意义了。因为只要windows安装了Vcxsrv之后，export DISPLAY，图形界面相关的信息被传输到我的windows电脑上再进行渲染，完全不需要桌面也可以显示图形界面。既有了图形界面的好处，有不必启动整个耗资源的桌面环境，实在是不错

最后就是Ubuntu mate了。Ubuntu在国内用的人越来越多，难不成因为Ubuntu对新手特别友好，而在中国刚刚开始接触linux的人越来越多？
可能确实Ubuntu比较完善吧，之前想要配置samba的服务，有一个system-config-samba只有ubuntu有，当时我真的想抛弃raspbian奔向ubuntu，因为其他的图形界面配置软件真是太无语了，完全不会用。不过最后直接去ubuntu源下载deb包就可以在raspbian安装了。。。
还有我用移动硬盘，raspbian自带的文件管理器只会取消挂载，不是真正的windows里的弹出，因为硬盘的灯闪的不一样。我担心我的移动硬盘可能磁头还没收回来就被我拔了，导致硬盘弄坏。于是从此我投奔了ubuntu的文件管理器:nautilus，安装就就经常只用它了。

我最后还是打算用ubuntu mate，尝尝鲜。我手头还有一块小屏幕，鼠标键盘，能让我先通过屏幕配置。否则真的就是树莓派自闭，完全不能工作了。

https://github.com/TheRemote/Ubuntu-Server-raspi4-unofficial
这个看上去很不错，但是是树莓派4的
https://ubuntu.com/download/raspberry-pi
好吧是我的错，我要是早发现了这个就去安装这个了


## 2 初始设置
gsettings set org.gnome.Vino require-encription false
这里运行/usr/lib/vino/vino-server可以无密码vnc连接

https://www.raspberrypi.org/forums/viewtopic.php?t=144926
根据指示在/boot/config.txt
加上 hdmi_force_hotplug=1

sudo apt install xrdp
重启
直接连接出现问题
在设置里面关闭自动登录：control-center里的login window
也可以通过命令行打开： sudo lightdm-settings
users选项去掉automatic login的username
我还打开了上面的allow manual login

https://wiki.archlinux.org/index.php/Xrdp
Add allowed_users=anybody to /etc/X11/Xwrapper.config to allow anybody to start X

sudo raspi-config 增加显存，感觉太卡了

接下来就是配置启用ipv6
sudo nano /etc/modules
最后加上 ipv6
sudo modprobe ipv6

https://www.eukhost.com/kb/how-to-enable-ip-forwarding-on-linux-ipv4-ipv6/
To enable these changes permanently, you have to modify the configuration file of sysctl so that it loads our modifications each start. It is the file “/etc/sysctl.conf” to activate IPv4 IP forwarding. We will add or uncomment this line:

| net.ipv4.ip_forward = 1
For IPv6, we will do the same with this line:

| net.ipv6.conf.all.forwarding=1
The configuration can then be reloaded so that the changes take effect immediately:

| sysctl -p /etc/sysctl.conf
That’s it!

## 3 稳定使用